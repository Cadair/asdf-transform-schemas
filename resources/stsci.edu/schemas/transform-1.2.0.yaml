%YAML 1.1
---
$schema: "http://stsci.edu/schemas/yaml-schema/draft-01"
id: "http://stsci.edu/schemas/asdf/transform/transform-1.2.0"
title: >
  A generic type used to mark where other transforms are accepted.

description: >
  These objects are designed to be nested in arbitrary ways to build up
  transformation pipelines out of a number of low-level pieces.

examples:
  -
    - A transform with no bounding_box or compound_bounding_box
    - |
      !transform/transform-1.2.0
        name: test
  -
    - A transform with 1D bounding_box
    - |
      !transform/transform-1.2.0
        name: test
        bounding_box: [1.0, 2.0]
  -
    - A transform with 2D bounding_box
    - |
      !transform/transform-1.2.0
        name: test
        bounding_box:
          - [1.0, 2.0]
          - [3.0, 4.0]
  -
    - A transform with compound_bounding_box
    - |
      !transform/transform-1.2.0
        name: test
        compound_bounding_box:
          selector_args:
            - argument: x
              ignore: true
            - argument: y
              ignore: true
          cbbox:
            - key: [0, 1]
              bbox:
                - [2.0, 3.0]
                - [4.0, 5.0]
            - key: [6, 7]
              bbox:
                - [8.0, 9.0]
                - [10.0, 11.0]

definitions:
  base_transform:
    type: object
    properties:
      name:
        description: |
          A user-friendly name for the transform, to give it extra
          meaning.
        type: string

      inverse:
        description: |
          Explicitly sets the inverse transform of this transform.

          If the transform has a direct analytic inverse, this
          property is usually not necessary, as the ASDF-reading tool
          can provide it automatically.

        $ref: "transform-1.2.0"
    additionalProperties: true

allOf:
  - $ref: "#/definitions/base_transform"
  - oneOf:
    - properties:
        bounding_box:
          $ref: bounding_box-1.0.0
      required: [bounding_box]
    - properties:
        compound_bounding_box:
          $ref: compound_bounding_box-1.0.0
      required: [compound_bounding_box]
    - properties:
        bounding_box: {not: {}}
        compound_bounding_box: {not: {}}
...
